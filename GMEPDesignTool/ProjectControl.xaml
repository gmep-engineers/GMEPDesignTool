<UserControl x:Class="GMEPDesignTool.ProjectControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:GMEPDesignTool"
             xmlns:uc="clr-namespace:GMEPDesignTool"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800"
             xmlns:gif="http://wpfanimatedgif.codeplex.com"
             xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit">
    <UserControl.Resources>
        <CollectionViewSource x:Key="EquipmentViewSource" Source="{Binding ElectricalEquipments}" />
        <CollectionViewSource x:Key="LightingViewSource" Source="{Binding ElectricalLightings}" />
        <BooleanToVisibilityConverter x:Key="BoolToVisConverter"/>
    </UserControl.Resources>
    <Grid Background="White">
        <TabControl>
            <TabItem Header="Structural" Visibility="Visible">
                <Grid Background="LightBlue" />
            </TabItem>
            <TabItem Header="Mechanical" Visibility="Visible">
                <Grid Background="White"/>
            </TabItem>
            <TabItem Header="Electrical" Visibility="Visible" Height="20" VerticalAlignment="Top">
                <Grid Background="White">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="200"/>
                        <RowDefinition Height="5"/>
                        <RowDefinition Height="200"/>
                        <RowDefinition Height="5"/>
                        <RowDefinition Height="200"/>
                        <RowDefinition Height="5"/>
                        <RowDefinition Height="*"/>
                
                    </Grid.RowDefinitions>
                    <GroupBox Grid.Row="0" Header="Electrical Services"  VerticalAlignment="Top">
                        <Grid>
                            <ScrollViewer Margin="0 0 50 0" ScrollViewer.HorizontalScrollBarVisibility="Auto" ScrollViewer.VerticalScrollBarVisibility="Auto">
                                <!-- Make Dynamic -->
                                <ItemsControl ItemsSource="{Binding ElectricalServices}" AlternationCount="2">
                                    <ItemsControl.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <StackPanel Orientation="Vertical"/>
                                        </ItemsPanelTemplate>
                                    </ItemsControl.ItemsPanel>
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Grid x:Name="ServiceGrid" Height="90" Margin="0 0 0 0" VerticalAlignment="Top">
                                                <xctk:ColorPicker Name="ClrPcker_Background" Margin="2,2,0,0" Width="100" HorizontalAlignment="Left" VerticalAlignment="Top" SelectedColor="{Binding ColorCode}"></xctk:ColorPicker>
                                                <ComboBox Height="20" Width="110" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="110,2,0,0" HorizontalContentAlignment="Right" SelectedValue="{Binding Config}" SelectedValuePath="Tag">
                                                    <ComboBoxItem Content="Switch Gear" HorizontalContentAlignment="Left" Tag="1"/>
                                                    <ComboBoxItem Content="Multi Meter" HorizontalContentAlignment="Left" Tag="2" />
                                                </ComboBox>
                                                <Image gif:ImageBehavior.AnimatedSource="PowerIcon.gif" Margin="230,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Top" Height="25">
                                                    <Image.ToolTip>
                                                        <ToolTip>
                                                            <TextBlock Text="Powered" />
                                                        </ToolTip>
                                                    </Image.ToolTip>
                                                </Image>
                                                <Rectangle Width="320" Height="45" Stroke="Gray" HorizontalAlignment="Left" Margin="0 30 0 0" Fill="{Binding ColorCode}" VerticalAlignment="Top"/>
                                                <Label Content="Name" Margin="10,27,0,0" />
                                                <TextBox Height="20" VerticalAlignment="Top" Margin="10,50,0,0" HorizontalAlignment="Left" Width="70" Text="{Binding Name}"/>
                                                <Label Content="Voltage" Margin="100 27 0 0"/>
                                                <ComboBox Height="20" Width="105" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="100 50 0 0" SelectedValue="{Binding Type}" SelectedValuePath="Tag">
                                                    <ComboBoxItem Content="120/208V 3-Φ" Tag="1" />
                                                    <ComboBoxItem Content="120/240V 1-Φ" Tag="2" />
                                                    <ComboBoxItem Content="277/480V 3-Φ" Tag="3" />
                                                    <ComboBoxItem Content="120/240V 3-Φ" Tag="4" />
                                                </ComboBox>
                                                <Label Content="Amp"  VerticalAlignment="Top" HorizontalAlignment="Left"  Margin="230 27 0 0"/>
                                                <ComboBox Height="20" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="230 50 150 0" Width="60" SelectedValue="{Binding Amp}" SelectedValuePath="Tag">
                                                    <ComboBoxItem Content="100" Tag="1"/>
                                                    <ComboBoxItem Content="200" Tag="2"/>
                                                    <ComboBoxItem Content="400" Tag="3"/>
                                                    <ComboBoxItem Content="600" Tag="4"/>
                                                    <ComboBoxItem Content="800" Tag="5"/>
                                                    <ComboBoxItem Content="1000" Tag="6"/>
                                                    <ComboBoxItem Content="1200" Tag="7"/>
                                                    <ComboBoxItem Content="1600" Tag="8"/>
                                                    <ComboBoxItem Content="2000" Tag="9"/>
                                                    <ComboBoxItem Content="2200" Tag="10"/>
                                                    <ComboBoxItem Content="3000" Tag="11"/>
                                                    <ComboBoxItem Content="4000" Tag="12"/>
                                                </ComboBox>
                                                <Grid Margin="0, 0, 0, 0" HorizontalAlignment="Right">
                                                    <Rectangle x:Name="DeleteSeparator" HorizontalAlignment="Right" Height="900" Margin="0,0,80,0" Stroke="LightGray" VerticalAlignment="Center"/>
                                                    <Button Height="20" Width="50" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="0 0 0 0" Content="Delete" FontWeight="Bold" Click="DeleteSelectedElectricalService" CommandParameter="{Binding}"/>
                                                </Grid>
                                            </Grid>
                                            <DataTemplate.Triggers>
                                                <Trigger Property="ItemsControl.AlternationIndex" Value="0">
                                                    <Setter Property="Background" Value="White" TargetName="ServiceGrid"/>
                                                    <Setter Property="Stroke" Value="LightGray" TargetName="DeleteSeparator"/>
                                                </Trigger>
                                                <Trigger Property="ItemsControl.AlternationIndex" Value="1">
                                                    <Setter Property="Background" Value="LightGray" TargetName="ServiceGrid"/>
                                                    <Setter Property="Stroke" Value="White" TargetName="DeleteSeparator"/>
                                                </Trigger>
                                            </DataTemplate.Triggers>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>

                                <!-- End Dynamic -->
                            </ScrollViewer>
                            <Grid HorizontalAlignment="Right">
                                <Label VerticalAlignment="Top" Margin="7,0,0,0" HorizontalAlignment="Left" Foreground="Blue" >
                                    <TextBlock TextDecorations="Underline">[hide]</TextBlock>
                                </Label>
                                <Rectangle Height="900" Stroke="LightGray" HorizontalAlignment="Left" Margin="0 0 48 0" VerticalAlignment="Top"/>
                                <Button Height="20" Width="20" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="5 0 0 0" Content="+" Click="AddNewElectricalService"/>
                            </Grid>
                        </Grid>
                    </GroupBox>
                    <GridSplitter Grid.Row="1" HorizontalAlignment="Stretch" Height="5" VerticalAlignment="Top"/>
                    <GroupBox Grid.Row="2" Header="Transformers" Height="Auto" VerticalAlignment="Top">
                        <Grid>
                            <ScrollViewer Margin="0 0 50 0" ScrollViewer.VerticalScrollBarVisibility="Auto" ScrollViewer.HorizontalScrollBarVisibility="Auto">
                                <ItemsControl ItemsSource="{Binding ElectricalTransformers}" AlternationCount="2">
                                    <ItemsControl.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <StackPanel Orientation="Vertical"/>
                                        </ItemsPanelTemplate>
                                    </ItemsControl.ItemsPanel>
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Grid x:Name="PanelGrid" Height="90" Margin="0 0 0 0" VerticalAlignment="Top">
                                                <Grid Width="Auto">
                                                    <xctk:ColorPicker Name="ClrPcker_Background" Margin="2,2,0,0" Width="100" HorizontalAlignment="Left" VerticalAlignment="Top" SelectedColor="{Binding ColorCode}"></xctk:ColorPicker>
                                                    <Image gif:ImageBehavior.AnimatedSource="PowerIcon.gif" Margin="110,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Top" Height="25" Visibility="{Binding Powered, Converter={StaticResource BoolToVisConverter}}">
                                                        <Image.ToolTip>
                                                            <ToolTip>
                                                                <TextBlock Text="Powered" />
                                                            </ToolTip>
                                                        </Image.ToolTip>
                                                    </Image>
                                                    <Rectangle Width="250" Height="45" Stroke="Gray" HorizontalAlignment="Left" Margin="0 30 0 0" Fill="{Binding ColorCode}" VerticalAlignment="Top"/>


                                                    <Label VerticalAlignment="Top" Margin="10,27,0,0" HorizontalAlignment="Left" Content="Name" FontWeight="Bold"/>
                                                    <TextBox Text="{Binding Name}" Height="20" Width="80" Margin="10,30,0,0" HorizontalAlignment="Left"/>

                                                    <Label Content="Voltage" Margin="110 27 0 0" FontWeight="Bold"/>
                                                    <ComboBox Height="20" Width="130" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="110 50 0 0" SelectedValue="{Binding Voltage}" SelectedValuePath="Tag">
                                                        <ComboBoxItem Content="480V-120/208V-3" Tag="1" />
                                                        <ComboBoxItem Content="208V-277/480V-3" Tag="2" />
                                                        <ComboBoxItem Content="480V-120/240V-3" Tag="3" />
                                                        <ComboBoxItem Content="240V-277/480V-3" Tag="4" />
                                                        <ComboBoxItem Content="240V-120/208V-3" Tag="5" />
                                                        <ComboBoxItem Content="208V-120/240V-3" Tag="6" />
                                                        <ComboBoxItem Content="240V-120/208V-1" Tag="7" />
                                                        <ComboBoxItem Content="208V-120/240V-1" Tag="8" />
                                                    </ComboBox>

                                                    <Label VerticalAlignment="Top" Margin="270,0,0,0" HorizontalAlignment="Left" Content="Fed From" FontWeight="Bold"/>
                                                    <ComboBox Height="20" Width="80" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="270 23 0 0" HorizontalContentAlignment="Right" SelectedValue="{Binding ParentId}" SelectedValuePath="Key" ItemsSource="{Binding DataContext.FedFromNames, RelativeSource={RelativeSource AncestorType=UserControl}}" DisplayMemberPath="Value"/>
                                                    <Label VerticalAlignment="Top" Margin="270,42,0,0" HorizontalAlignment="Left" Content="Distance" FontWeight="Bold"/>
                                                    <TextBox Text="{Binding DistanceFromParent}" Height="20" Width="80" Margin="270,55,0,0" HorizontalAlignment="Left"/>
                                                    <Label VerticalAlignment="Top" Margin="370,28,0,0" HorizontalAlignment="Left" Content="KVA" FontWeight="Bold"/>
                                                    <ComboBox Height="20" VerticalAlignment="Top" Margin="370,50,150,0" HorizontalAlignment="Left" Width="90"  IsReadOnly="True" IsEnabled="False" SelectedValue="{Binding Kva}" SelectedValuePath="Tag">
                                                        <ComboBoxItem Content="45" Tag="1"/>
                                                        <ComboBoxItem Content="75" Tag="2"/>
                                                        <ComboBoxItem Content="112.5" Tag="3"/>
                                                        <ComboBoxItem Content="150" Tag="4"/>
                                                        <ComboBoxItem Content="225" Tag="5"/>
                                                        <ComboBoxItem Content="300" Tag="6"/>
                                                        <ComboBoxItem Content="500" Tag="7"/>
                                                        <ComboBoxItem Content="750" Tag="8"/>
                                                        <ComboBoxItem Content="1000" Tag="9"/>
                                                        <ComboBoxItem Content="1500" Tag="10"/>
                                                        <ComboBoxItem Content="2000" Tag="11"/>
                                                        <ComboBoxItem Content="2500" Tag="12"/>
                                                        <ComboBoxItem Content="TOO HIGH" Tag="13"/>
                                                    </ComboBox>
                                                </Grid>
                                                <Grid Margin="20 0" HorizontalAlignment="Right"  >
                                                    <Rectangle x:Name="DeleteSeparator" HorizontalAlignment="Right" Height="900" Margin="0,0,80,0" Stroke="LightGray" VerticalAlignment="Center"/>
                                                    <Button Height="20" Width="50" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="0 0 0 0" Content="Delete" FontWeight="Bold" Click="DeleteSelectedElectricalTransformer" CommandParameter="{Binding}"/>
                                                </Grid>
                                            </Grid>
                                            <DataTemplate.Triggers>
                                                <Trigger Property="ItemsControl.AlternationIndex" Value="0">
                                                    <Setter Property="Background" Value="White" TargetName="PanelGrid"/>
                                                    <Setter Property="Stroke" Value="LightGray" TargetName="DeleteSeparator"/>
                                                </Trigger>
                                                <Trigger Property="ItemsControl.AlternationIndex" Value="1">
                                                    <Setter Property="Background" Value="LightGray" TargetName="PanelGrid"/>
                                                    <Setter Property="Stroke" Value="White" TargetName="DeleteSeparator"/>
                                                </Trigger>
                                            </DataTemplate.Triggers>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </ScrollViewer>
                            <Grid HorizontalAlignment="Right">
                                <Label VerticalAlignment="Top" Margin="7,0,0,0" HorizontalAlignment="Left" Foreground="Blue" >
                                    <TextBlock TextDecorations="Underline">[hide]</TextBlock>
                                </Label>
                                <Rectangle Height="900" Stroke="LightGray" HorizontalAlignment="Left" Margin="0 0 48 0" VerticalAlignment="Top"/>
                                <Button Height="20" Width="20" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="5 0 0 0" Content="+" Click="AddNewElectricalTransformer"/>
                            </Grid>
                        </Grid>
                    </GroupBox>
                    <GridSplitter Grid.Row="3" HorizontalAlignment="Stretch" Height="5" VerticalAlignment="Top"/>
                    <!-- New Transformer-->
                    <GroupBox Grid.Row="4" Header="Panels" Height="Auto" VerticalAlignment="Top">
                        <Grid>
                            <ScrollViewer Margin="0 0 50 0" ScrollViewer.VerticalScrollBarVisibility="Auto" ScrollViewer.HorizontalScrollBarVisibility="Auto">
                                <ItemsControl ItemsSource="{Binding ElectricalPanels}" AlternationCount="2">
                                    <ItemsControl.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <StackPanel Orientation="Vertical"/>
                                        </ItemsPanelTemplate>
                                    </ItemsControl.ItemsPanel>
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Grid x:Name="PanelGrid" Height="90" Margin="0 0 0 0" VerticalAlignment="Top">
                                                <Grid Width="Auto">
                                                    <xctk:ColorPicker Name="ClrPcker_Background" Margin="2,2,0,0" Width="100" HorizontalAlignment="Left" VerticalAlignment="Top" SelectedColor="{Binding ColorCode}"></xctk:ColorPicker>
                                                    <ComboBox Height="20" Width="70" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="110,2,0,0" HorizontalContentAlignment="Right" SelectedIndex="{Binding IsDistribution}">
                                                        <ComboBoxItem Content="Panel" HorizontalContentAlignment="Left"/>
                                                        <ComboBoxItem Content="Distrib." HorizontalContentAlignment="Left" />
                                                    </ComboBox>
                                                    <Image gif:ImageBehavior.AnimatedSource="PowerIcon.gif" Margin="190,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Top" Height="25" Visibility="{Binding Powered, Converter={StaticResource BoolToVisConverter}}">
                                                        <Image.ToolTip>
                                                            <ToolTip>
                                                                <TextBlock Text="Powered" />
                                                            </ToolTip>
                                                        </Image.ToolTip>
                                                    </Image>
                                                    <Rectangle Width="450" Height="45" Stroke="Gray" HorizontalAlignment="Left" Margin="0 30 0 0" Fill="{Binding ColorCode}" VerticalAlignment="Top"/>


                                                    <Label VerticalAlignment="Top" Margin="10,27,0,0" HorizontalAlignment="Left" Content="Name" FontWeight="Bold"/>
                                                    <TextBox Height="20" VerticalAlignment="Top" Margin="10,50,0,0" HorizontalAlignment="Left" Width="70" TextAlignment="Center" CharacterCasing="Upper" Text="{Binding Name}"/>

                                                    <Label Content="Voltage" Margin="100 27 0 0" FontWeight="Bold"/>
                                                    <ComboBox Height="20" Width="105" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="100 50 0 0" SelectedValue="{Binding Type}" SelectedValuePath="Tag">
                                                        <ComboBoxItem Content="120/208V 3-Φ" Tag="1" />
                                                        <ComboBoxItem Content="120/240V 1-Φ" Tag="2"/>
                                                        <ComboBoxItem Content="277/480V 3-Φ" Tag="3" />
                                                        <ComboBoxItem Content="120/240V 3-Φ" Tag="4" />
                                                    </ComboBox>

                                                    <Label VerticalAlignment="Top" Margin="230,28,0,0" HorizontalAlignment="Left" Content="Main (A)" FontWeight="Bold"/>
                                                    <ComboBox SelectedValue="{Binding MainSize}" SelectedValuePath="Tag" Height="20" VerticalAlignment="Top" Margin="230,50,0,0" HorizontalAlignment="Left" Width="50" >
                                                        <ComboBoxItem Content="60" Tag="1"/>
                                                        <ComboBoxItem Content="100" Tag="2"/>
                                                        <ComboBoxItem Content="125" Tag="3"/>
                                                        <ComboBoxItem Content="150" Tag="4"/>
                                                        <ComboBoxItem Content="175" Tag="5"/>
                                                        <ComboBoxItem Content="200" Tag="6"/>
                                                        <ComboBoxItem Content="225" Tag="7"/>
                                                        <ComboBoxItem Content="250" Tag="8"/>
                                                        <ComboBoxItem Content="275" Tag="9"/>
                                                        <ComboBoxItem Content="400" Tag="10"/>
                                                        <ComboBoxItem Content="500" Tag="11"/>
                                                        <ComboBoxItem Content="600" Tag="12"/>
                                                        <ComboBoxItem Content="800" Tag="13"/>
                                                    </ComboBox>
                                                    <Label VerticalAlignment="Top" Margin="300,28,0,0" HorizontalAlignment="Left" Content="Bus (A)" FontWeight="Bold"/>
                                                    <ComboBox SelectedValue="{Binding BusSize}" SelectedValuePath="Tag" Height="20" VerticalAlignment="Top" Margin="300,50,0,0" HorizontalAlignment="Left" Width="50" >
                                                        <ComboBoxItem Content="60" Tag="1"/>
                                                        <ComboBoxItem Content="100" Tag="2"/>
                                                        <ComboBoxItem Content="125" Tag="3"/>
                                                        <ComboBoxItem Content="150" Tag="4"/>
                                                        <ComboBoxItem Content="175" Tag="5"/>
                                                        <ComboBoxItem Content="200" Tag="6"/>
                                                        <ComboBoxItem Content="225" Tag="7"/>
                                                        <ComboBoxItem Content="250" Tag="8"/>
                                                        <ComboBoxItem Content="275" Tag="9"/>
                                                        <ComboBoxItem Content="400" Tag="10"/>
                                                        <ComboBoxItem Content="500" Tag="11"/>
                                                        <ComboBoxItem Content="600" Tag="12"/>
                                                        <ComboBoxItem Content="800" Tag="13"/>
                                                    </ComboBox>


                                                    <Label VerticalAlignment="Top" Margin="370,28,0,0" HorizontalAlignment="Left" Content="# Breakers" FontWeight="Bold"/>
                                                    <TextBox Text="{Binding NumBreakers}" Height="20" VerticalAlignment="Top" Margin="370,50,0,0" HorizontalAlignment="Left" Width="70" TextAlignment="Right" CharacterCasing="Upper"/>
                                                    <Label VerticalAlignment="Top" Margin="460,0,0,0" HorizontalAlignment="Left" Content="Fed From" FontWeight="Bold"/>
                                                    <ComboBox x:Name="PanelParent" Height="20" Width="80" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="460 23 0 0" HorizontalContentAlignment="Right" SelectedValue="{Binding FedFromId}" SelectedValuePath="Key" ItemsSource="{Binding DataContext.FedFromNames, RelativeSource={RelativeSource AncestorType=UserControl}}" DisplayMemberPath="Value"/>
                                                    <Label VerticalAlignment="Top" Margin="460,42,0,0" HorizontalAlignment="Left" Content="Distance" FontWeight="Bold"/>
                                                    <TextBox Text="{Binding DistanceFromParent}" Height="20" Width="80" Margin="460,55,0,0" HorizontalAlignment="Left"/>
                                                    <Label VerticalAlignment="Top" Margin="560,28,0,0" HorizontalAlignment="Left" Content="KVA" FontWeight="Bold"/>
                                                    <TextBox Height="20" VerticalAlignment="Top" Margin="560,50,0,0" HorizontalAlignment="Left" Width="80" TextAlignment="Right" IsReadOnly="True" Background="LightYellow" Text="{Binding Kva}"/>
                                                    <Label VerticalAlignment="Top" Margin="660,28,0,0" HorizontalAlignment="Left" Content="A" FontWeight="Bold" />
                                                    <TextBox Height="20" VerticalAlignment="Top" Margin="660,50,150,0" HorizontalAlignment="Left" Width="80"  TextAlignment="Right" IsReadOnly="True" Background="LightYellow" Text="{Binding Amp}" />
                                                    <Label VerticalAlignment="Top" Margin="760,28,0,0" HorizontalAlignment="Left" Content="AIC Rating" FontWeight="Bold"/>
                                                    <TextBox Text="{Binding AicRating}" Height="20" VerticalAlignment="Top" Margin="760,50,150,0" HorizontalAlignment="Left" Width="80"  TextAlignment="Right"/>
                                                </Grid>
                                                <Grid Margin="20 0" HorizontalAlignment="Right"  >
                                                    <Rectangle x:Name="DeleteSeparator" HorizontalAlignment="Right" Height="900" Margin="0,0,80,0" Stroke="LightGray" VerticalAlignment="Center"/>
                                                    <Button Height="20" Width="50" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="0 0 0 0" Content="Delete" FontWeight="Bold" Click="DeleteSelectedElectricalPanel" CommandParameter="{Binding}"/>
                                                </Grid>
                                            </Grid>
                                            <DataTemplate.Triggers>
                                                <Trigger Property="ItemsControl.AlternationIndex" Value="0">
                                                    <Setter Property="Background" Value="White" TargetName="PanelGrid"/>
                                                    <Setter Property="Stroke" Value="LightGray" TargetName="DeleteSeparator"/>
                                                </Trigger>
                                                <Trigger Property="ItemsControl.AlternationIndex" Value="1">
                                                    <Setter Property="Background" Value="LightGray" TargetName="PanelGrid"/>
                                                    <Setter Property="Stroke" Value="White" TargetName="DeleteSeparator"/>
                                                </Trigger>
                                            </DataTemplate.Triggers>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </ScrollViewer>
                            <Grid HorizontalAlignment="Right">
                                <Label VerticalAlignment="Top" Margin="7,0,0,0" HorizontalAlignment="Left" Foreground="Blue" >
                                    <TextBlock TextDecorations="Underline">[hide]</TextBlock>
                                </Label>
                                <Rectangle Height="900" Stroke="LightGray" HorizontalAlignment="Left" Margin="0 0 48 0" VerticalAlignment="Top"/>
                                <Button Height="20" Width="20" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="5 0 0 0" Content="+" Click="AddNewElectricalPanel"/>
                            </Grid>
                        </Grid>
                    </GroupBox>
                    <GridSplitter Grid.Row="5" HorizontalAlignment="Stretch" Height="5" VerticalAlignment="Top"/>
                    <!-- End Transformer-->
                    <TabControl Grid.Row="6">
                        <TabItem Header="Equipment">
                            <GroupBox  Header="Equipment" Height="Auto" VerticalAlignment="Top" >
                                <Grid Width="Auto">
                                    <StackPanel Orientation="Vertical">
                                        <Grid Width="Auto" Height="37" HorizontalAlignment="Left" VerticalAlignment="Top" Background="Gainsboro" Margin="0 3 0 0" >
                                            <Label Content="Category" Margin="0 3 0 0"/>
                                            <ComboBox x:Name="CategoryFilter" Height="20" Width="80" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="60 7 0 0" SelectionChanged="EquipmentFilter_SelectionChanged" SelectedValuePath="Tag">
                                                <ComboBoxItem Content="" Tag="" />
                                                <ComboBoxItem Content="General" Tag="1" />
                                                <ComboBoxItem Content="Mechanical" Tag="2" />
                                                <ComboBoxItem Content="Lighting" Tag="3" />
                                                <ComboBoxItem Content="Plumbing" Tag="4" />
                                            </ComboBox>
                                            <Label Content="Panel" Margin="150 3 0 0"/>
                                            <ComboBox x:Name="PanelFilter" Height="20"  Width="80" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="190 7 0 0" ItemsSource="{Binding PanelNames}" SelectionChanged="EquipmentFilter_SelectionChanged" DisplayMemberPath="Value"/>
                                            <Label Content="Voltage" Margin="280 3 0 0"/>
                                            <ComboBox x:Name="VoltageFilter"  Height="20" Width="80" VerticalAlignment="Top" SelectedValuePath="Tag" SelectionChanged="EquipmentFilter_SelectionChanged" HorizontalAlignment="Left" Margin="330 7 0 0">
                                                <ComboBoxItem Content="" Background="White" Tag="" />
                                                <ComboBoxItem Content="115" Background="NavajoWhite" Tag="1" />
                                                <ComboBoxItem Content="120" Background="PaleGoldenrod" Tag="2"/>
                                                <ComboBoxItem Content="208" Background="PaleGreen" Tag="3"/>
                                                <ComboBoxItem Content="230" Background="PaleTurquoise" Tag="4"/>
                                                <ComboBoxItem Content="240" Background="SkyBlue" Tag="5"/>
                                                <ComboBoxItem Content="460" Background="Thistle" Tag="6"/>
                                                <ComboBoxItem Content="480" Background="Plum" Tag="7"/>
                                            </ComboBox>
                                            <Label Content="Phase" Margin="420 3 0 0"/>
                                            <ComboBox x:Name="PhaseFilter" Height="20" Width="35" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="460 7 0 0" SelectionChanged="EquipmentFilter_SelectionChanged">
                                                <ComboBoxItem Content="" />
                                                <ComboBoxItem Content="1" />
                                                <ComboBoxItem Content="3" />
                                            </ComboBox>
                                            <Label Content="Equip #" Margin="510 3 0 0"/>
                                            <TextBox x:Name="EquipmentFilter" Height="20" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="560 7 0 0" Width="69" TextChanged="EquipmentFilter_TextChanged"></TextBox>
                                            <Label Margin="670 2 0 0">
                                                <Hyperlink x:Name="ResetFilters" TextDecorations="Underline" Foreground="Blue" Click="ResetFilters_Click" >[reset filters]</Hyperlink>
                                            </Label>
                                            <Grid Background="Gainsboro" Height="Auto" HorizontalAlignment="Right">
                                                <Rectangle Height="30" Width="1" Stroke="White"  Margin="0 0 150 0" VerticalAlignment="Center"/>
                                                <Button Width="100" VerticalAlignment="Center"  Margin="0 0 20 0" Content="New" Click="AddNewElectricalEquipment"/>
                                            </Grid>
                                            <Rectangle Width="9999" Height="1" Margin="0 35 0 0" Stroke="White" HorizontalAlignment="Left" VerticalAlignment="Top"/>
                                        </Grid>
                                    </StackPanel>
                                    <ScrollViewer Margin="0 40 0 0" ScrollViewer.VerticalScrollBarVisibility="Auto" ScrollViewer.HorizontalScrollBarVisibility="Auto">
                                        <ItemsControl ItemsSource="{Binding Source={StaticResource EquipmentViewSource}}" AlternationCount="2">
                                            <ItemsControl.ItemsPanel>
                                                <ItemsPanelTemplate>
                                                    <StackPanel Orientation="Vertical" Height="Auto"/>
                                                </ItemsPanelTemplate>
                                            </ItemsControl.ItemsPanel>
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate>
                                                    <DataTemplate.Resources>
                                                        <x:Array Type="{x:Type ComboBoxItem}" x:Key="VoltageItemsCategory3">
                                                            <ComboBoxItem Content="120" Background="PaleGoldenrod" Tag="2"/>
                                                            <ComboBoxItem Content="277" Background="SkyBlue" Tag="6"/>
                                                        </x:Array>
                                                        <x:Array Type="{x:Type ComboBoxItem}" x:Key="VoltageItems">
                                                            <ComboBoxItem Content="115" Background="NavajoWhite" Tag="1" />
                                                            <ComboBoxItem Content="120" Background="PaleGoldenrod" Tag="2"/>
                                                            <ComboBoxItem Content="208" Background="PaleGreen" Tag="3"/>
                                                            <ComboBoxItem Content="230" Background="PaleTurquoise" Tag="4"/>
                                                            <ComboBoxItem Content="240" Background="SkyBlue" Tag="5"/>
                                                            <ComboBoxItem Content="277" Background="SkyBlue" Tag="6"/>
                                                            <ComboBoxItem Content="460" Background="Thistle" Tag="7"/>
                                                            <ComboBoxItem Content="480" Background="Plum" Tag="8"/>
                                                        </x:Array>
                                                    </DataTemplate.Resources>
                                                    <!-- Make Dynamic -->
                                                    <Grid x:Name="EquipmentGrid" Margin="0 0 0 0" VerticalAlignment="Top">
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="90"/>
                                                            <RowDefinition Height="*"/>
                                                        </Grid.RowDefinitions>
                                                        <StackPanel Orientation="Vertical" Grid.Row="0" Height="85" Width="Auto" VerticalAlignment="Top">
                                                            <StackPanel Orientation="Horizontal">
                                                                <xctk:ColorPicker Name="ClrPcker_Background" Margin="2,2,0,0" Width="100" HorizontalAlignment="Left" VerticalAlignment="Top" SelectedColor="{Binding ColorCode}"></xctk:ColorPicker>
                                                                <ComboBox Height="22" Width="100" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="10 2 0 0" SelectedValue="{Binding Category}" SelectedValuePath="Tag">
                                                                    <ComboBoxItem Content="General" Tag="1"/>
                                                                    <ComboBoxItem Content="Mechanical" Tag="2" />
                                                                    <ComboBoxItem Content="Lighting" Tag="3"/>
                                                                    <ComboBoxItem Content="Plumbing"  Tag="4"/>
                                                                </ComboBox>
                                                                <ComboBox x:Name="MountingBox" Height="22" Width="100" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="10 2 0 0"  SelectedValue="{Binding Mounting}" SelectedValuePath="Tag" Visibility="Collapsed">
                                                                    <ComboBoxItem Content="Recessed" Tag="1"/>
                                                                    <ComboBoxItem Content="Surface" Tag="2" />
                                                                    <ComboBoxItem Content="Pendant" Tag="3"/>
                                                                </ComboBox>
                                                                <Image gif:ImageBehavior.AnimatedSource="PowerIcon.gif" Margin="10,2,0,0" HorizontalAlignment="Left" VerticalAlignment="Top" Height="25" Visibility="{Binding Powered, Converter={StaticResource BoolToVisConverter}}">
                                                                    <Image.ToolTip>
                                                                        <ToolTip>
                                                                            <TextBlock Text="Powered" />
                                                                        </ToolTip>
                                                                    </Image.ToolTip>
                                                                </Image>
                                                            </StackPanel>
                                                            <StackPanel Orientation="Horizontal">
                                                                <Grid HorizontalAlignment="Left">
                                                                    <Rectangle  Height="55" HorizontalAlignment="Stretch" Stroke="Gray" Margin="0 2 0 0" Fill="{Binding ColorCode}" VerticalAlignment="Top" />
                                                                    <StackPanel Orientation="Horizontal">
                                                                        <Grid Margin="10 0 0 0">
                                                                            <Label Content="Owner" Margin="0 0 0 0" FontWeight="Bold"/>
                                                                            <ComboBox Height="30" Width="150" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="0 20 0 0" SelectedValue="{Binding Owner}" SelectedValuePath="Key"  ItemsSource="{Binding DataContext.Owners, RelativeSource={RelativeSource AncestorType=UserControl}}" DisplayMemberPath="Value"/>
                                                                        </Grid>
                                                                        <Grid Margin="20 0 0 0">
                                                                            <Label Content="Equip #"  FontWeight="Bold"/>
                                                                            <TextBox Height="30" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="0 20 0 0" Width="69" Text="{Binding EquipNo}"></TextBox>
                                                                        </Grid>
                                                                        <Grid Margin="20 0 0 0">
                                                                            <Label Content="Voltage" FontWeight="Bold"/>
                                                                            <ComboBox x:Name="VoltageBox" Height="30" Width="150" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="0 20 0 0" SelectedValuePath="Tag" ItemsSource="{StaticResource VoltageItems}" SelectedValue="{Binding Voltage}"/>
                                                                        </Grid>
                                                                        <Grid Margin="20 0 0 0">
                                                                            <Label Content="Amp" VerticalAlignment="Top" HorizontalAlignment="Left"  FontWeight="Bold"/>
                                                                            <TextBox x:Name="AmpText" Height="30" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="0 20 0 0" Width="50" Text="{Binding Amp}"></TextBox>
                                                                        </Grid>
                                                                        <Grid Margin="20 0 0 0">
                                                                            <Label x:Name="VALabel" Content="VA" VerticalAlignment="Top" HorizontalAlignment="Left"  FontWeight="Bold"/>
                                                                            <TextBox x:Name="VABox" Height="30" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="0 20 0 0" Width="70" Text="{Binding Va}" Background="LightYellow" IsReadOnly="True"></TextBox>
                                                                        </Grid>
                                                                        <Grid Margin="20 0 10 0">
                                                                            <Label Content="Phase"  FontWeight="Bold"/>
                                                                            <ComboBox x:Name="PhaseBox" Height="30" Width="150" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="0 20 0 0" SelectedIndex="{Binding Is3Ph}">
                                                                                <ComboBoxItem Content="1" />
                                                                                <ComboBoxItem Content="3" />
                                                                            </ComboBox>
                                                                        </Grid>
                                                                    </StackPanel>
                                                                </Grid>
                                                                <Grid Margin="20 0 0 0">
                                                                    <Label Content="Qty." FontWeight="Bold"/>
                                                                    <TextBox Height="30" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="0 20 0 0" Width="43">
                                                                        <TextBox.Text>
                                                                            <Binding Path="Qty" UpdateSourceTrigger="PropertyChanged">
                                                                                <Binding.ValidationRules>
                                                                                    <local:MinimumValueValidationRule Minimum="1"/>
                                                                                </Binding.ValidationRules>
                                                                            </Binding>
                                                                        </TextBox.Text>
                                                                    </TextBox>
                                                                </Grid>

                                                                <Grid Margin="20 -20 0 0">
                                                                    <Label Content="Panel" FontWeight="Bold"/>
                                                                    <ComboBox Height="20" Width="150" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="0 20 0 0" SelectedValue="{Binding ParentId}" SelectedValuePath="Key" ItemsSource="{Binding DataContext.PanelNames, RelativeSource={RelativeSource AncestorType=UserControl}}" DisplayMemberPath="Value"/>

                                                                    <Label Content="Distance" Margin="0 35 0 0" FontWeight="Bold"/>
                                                                    <TextBox Height="20" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="0 55 0 0" Width="150" Text="{Binding DistanceFromParent}"></TextBox>
                                                                </Grid>

                                                                <Grid Margin="20 0 0 0">
                                                                    <Label Content="AIC Rating" FontWeight="Bold"/>
                                                                    <TextBox Height="30" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="0 20 0 0" Width="70" Text="{Binding AicRating}"></TextBox>
                                                                </Grid>

                                                                <Grid Margin="20 -40 0 0">
                                                                    <Button  Height="20" Width="100" Content="View Spec" FontWeight="Bold" HorizontalAlignment="Left"/>
                                                                    <Button Margin="0 60 0 0" Height="20" Width="100" Content="Change Spec" FontWeight="Bold" HorizontalAlignment="Left"/>
                                                                </Grid>
                                                                <Grid Margin="20 15 150 0" >
                                                                    <CheckBox Margin="0 5 0 0" IsChecked="{Binding SpecSheetFromClient}" />
                                                                    <Label Margin="15 0 0 0" Content="From Client" FontWeight="Bold" />
                                                                </Grid>
                                                            </StackPanel>
                                                        </StackPanel>
                                                        <Expander Grid.Row="1" HorizontalAlignment="Left" Header="Description" FontWeight="Bold">
                                                            <TextBox x:Name="DescriptionBox" Height="100" Width="400" Margin="2 2 2 5" Text="{Binding Description}" MaxLength="25"/>
                                                        </Expander>
                                                        <Grid Margin="0, 0, 0, 0" HorizontalAlignment="Right" VerticalAlignment="Stretch" Grid.RowSpan="2">
                                                            <Rectangle x:Name="DeleteSeparator" HorizontalAlignment="Right" Height="Auto" Margin="0,0,80,0" Stroke="LightGray" VerticalAlignment="Stretch"/>
                                                            <Button Height="20" Width="50" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="0 0 0 0" Content="Delete" FontWeight="Bold" Click="DeleteSelectedElectricalEquipment" CommandParameter="{Binding}"/>
                                                        </Grid>
                                                    </Grid>
                                                    <DataTemplate.Triggers>
                                                        <Trigger Property="ItemsControl.AlternationIndex" Value="0">
                                                            <Setter Property="Background" Value="White" TargetName="EquipmentGrid"/>
                                                            <Setter Property="Stroke" Value="LightGray" TargetName="DeleteSeparator"/>
                                                        </Trigger>
                                                        <Trigger Property="ItemsControl.AlternationIndex" Value="1">
                                                            <Setter Property="Background" Value="LightGray" TargetName="EquipmentGrid"/>
                                                            <Setter Property="Stroke" Value="White" TargetName="DeleteSeparator"/>
                                                        </Trigger>
                                                        <DataTrigger Binding="{Binding Category}" Value="3">
                                                            <Setter Value="Watts" Property="Content" TargetName="VALabel"/>
                                                            <Setter Value="False" Property="IsEnabled" TargetName="PhaseBox"/>
                                                            <Setter Value="0" Property="SelectedIndex" TargetName="PhaseBox"/>
                                                            <Setter Value="False" TargetName="VABox" Property="IsReadOnly"/>
                                                            <Setter Value="White" TargetName="VABox" Property="Background"/>
                                                            <Setter Value="True" TargetName="AmpText" Property="IsReadOnly"/>
                                                            <Setter Value="LightYellow" TargetName="AmpText" Property="Background"/>
                                                            <Setter Value="{StaticResource VoltageItemsCategory3}" TargetName="VoltageBox" Property="ItemsSource"/>
                                                            <Setter Value="{Binding Voltage}" TargetName="VoltageBox" Property="SelectedValue"/>
                                                            <Setter TargetName="MountingBox" Property="Visibility" Value="Visible"/>
                                                            <Setter TargetName="DescriptionBox" Property="MaxLength" Value="100"/>
                                                        </DataTrigger>
                                                    </DataTemplate.Triggers>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>
                                        <!-- End Dynamic -->
                                    </ScrollViewer>
                                </Grid>
                            </GroupBox>
                        </TabItem>
                        <!-- End Transformer-->
                        <TabItem Header="Lighting">
                            <GroupBox Header="Lighting" Height="Auto" VerticalAlignment="Top">
                                <Grid>
                                    <StackPanel Orientation="Vertical">
                                        <Grid Background="Gainsboro">
                                            <StackPanel Orientation="Horizontal" Width="Auto" Height="37" HorizontalAlignment="Stretch" VerticalAlignment="Top" Margin="0 3 0 0" >
                                                <Label Content="Mounting" Margin="0 3 0 0"/>
                                                <ComboBox Height="20" Width="80" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="0 7 0 0"  SelectedValuePath="Tag">
                                                    <ComboBoxItem Content="" Tag="" />
                                                    <ComboBoxItem Content="General" Tag="1" />
                                                    <ComboBoxItem Content="Mechanical" Tag="2" />
                                                    <ComboBoxItem Content="Lighting" Tag="3" />
                                                    <ComboBoxItem Content="Plumbing" Tag="4" />
                                                </ComboBox>
                                                <Label Content="Panel" Margin="10 3 0 0"/>
                                                <ComboBox Height="20"  Width="80" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="0 7 0 0" ItemsSource="{Binding PanelNames}"  DisplayMemberPath="Value"/>


                                                <Label Content="Model #" Margin="10 3 0 0"/>
                                                <TextBox Height="20" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="0 7 0 0" Width="69"></TextBox>
                                                <Label Margin="10 3 0 0">
                                                    <Hyperlink TextDecorations="Underline" Foreground="Blue" >[reset filters]</Hyperlink>
                                                </Label>
                                            </StackPanel>
                                            <Grid Background="Gainsboro" Height="Auto" HorizontalAlignment="Right">
                                                <Rectangle Height="30" Width="1" Stroke="White"  Margin="0 0 150 0" VerticalAlignment="Center"/>
                                                <Button Width="100" VerticalAlignment="Center"  Margin="0 0 20 0" Content="New" Click="AddNewElectricalLighting"/>
                                            </Grid>
                                            <Rectangle Width="9999" Height="1" Margin="0 38 0 0" Stroke="White" HorizontalAlignment="Left" VerticalAlignment="Top"/>
                                        </Grid>
                                    </StackPanel>
                                    <ScrollViewer Margin="0 40 0 0" ScrollViewer.VerticalScrollBarVisibility="Auto" ScrollViewer.HorizontalScrollBarVisibility="Auto">
                                        <ItemsControl ItemsSource="{Binding Source={StaticResource LightingViewSource}}" AlternationCount="2">
                                            <ItemsControl.ItemsPanel>
                                                <ItemsPanelTemplate>
                                                    <StackPanel Orientation="Vertical" Height="Auto"/>
                                                </ItemsPanelTemplate>
                                            </ItemsControl.ItemsPanel>
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate>
                                                    <DataTemplate.Resources>
                                                        <x:Array Type="{x:Type ComboBoxItem}" x:Key="VoltageItemsLighting">
                                                            <ComboBoxItem Content="120" Background="PaleGoldenrod" Tag="2"/>
                                                            <ComboBoxItem Content="277" Background="SkyBlue" Tag="6"/>
                                                        </x:Array>
                                                        <x:Array Type="{x:Type ComboBoxItem}" x:Key="VoltageItems">
                                                            <ComboBoxItem Content="115" Background="NavajoWhite" Tag="1" />
                                                            <ComboBoxItem Content="120" Background="PaleGoldenrod" Tag="2"/>
                                                            <ComboBoxItem Content="208" Background="PaleGreen" Tag="3"/>
                                                            <ComboBoxItem Content="230" Background="PaleTurquoise" Tag="4"/>
                                                            <ComboBoxItem Content="240" Background="SkyBlue" Tag="5"/>
                                                            <ComboBoxItem Content="277" Background="SkyBlue" Tag="6"/>
                                                            <ComboBoxItem Content="460" Background="Thistle" Tag="7"/>
                                                            <ComboBoxItem Content="480" Background="Plum" Tag="8"/>
                                                        </x:Array>
                                                    </DataTemplate.Resources>
                                                    <!-- Make Dynamic -->
                                                    <Grid x:Name="EquipmentGrid" Margin="0 0 0 0" VerticalAlignment="Top">
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="90"/>
                                                            <RowDefinition Height="*"/>
                                                        </Grid.RowDefinitions>
                                                        <StackPanel Orientation="Vertical" Grid.Row="0" Height="85" Width="Auto" VerticalAlignment="Top">
                                                            <StackPanel Orientation="Horizontal">
                                                                <xctk:ColorPicker Name="ClrPcker_Background" Margin="2,2,0,0" Width="100" HorizontalAlignment="Left" VerticalAlignment="Top" SelectedColor="{Binding ColorCode}"></xctk:ColorPicker>
                                                                <ComboBox Height="22" Width="100" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="10 2 0 0" SelectedValue="{Binding Mounting}" SelectedValuePath="Tag">
                                                                    <ComboBoxItem Content="Recessed" Tag="1"/>
                                                                    <ComboBoxItem Content="Surface" Tag="2" />
                                                                    <ComboBoxItem Content="Pendant" Tag="3"/>
                                                                </ComboBox>
                                                                <Image gif:ImageBehavior.AnimatedSource="PowerIcon.gif" Margin="10,2,0,0" HorizontalAlignment="Left" VerticalAlignment="Top" Height="25" Visibility="{Binding Powered, Converter={StaticResource BoolToVisConverter}}">
                                                                    <Image.ToolTip>
                                                                        <ToolTip>
                                                                            <TextBlock Text="Powered" />
                                                                        </ToolTip>
                                                                    </Image.ToolTip>
                                                                </Image>
                                                            </StackPanel>
                                                            <StackPanel Orientation="Horizontal">
                                                                <Grid HorizontalAlignment="Left">
                                                                    <Rectangle  Height="55" HorizontalAlignment="Stretch" Stroke="Gray" Margin="0 2 0 0" Fill="{Binding ColorCode}" VerticalAlignment="Top" />
                                                                    <StackPanel Orientation="Horizontal">
                                                                        <Grid Margin="10 0 0 0">
                                                                            <Label Content="Manufacturer ID" Margin="0 0 0 0" FontWeight="Bold"/>
                                                                            <TextBox Height="30" Width="150" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="0 20 0 0" Text="{Binding Manufacturer}"/>
                                                                        </Grid>
                                                                        <Grid Margin="10 0 0 0">
                                                                            <Label Content="Model #"  FontWeight="Bold"/>
                                                                            <TextBox Height="30" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="0 20 0 0" Width="69" Text="{Binding ModelNo}"></TextBox>
                                                                        </Grid>
                                                                        <Grid Margin="20 0 0 0">
                                                                            <Label Content="Voltage" FontWeight="Bold"/>
                                                                            <ComboBox x:Name="VoltageBox" Height="30" Width="150" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="0 20 0 0" SelectedValuePath="Tag" ItemsSource="{StaticResource VoltageItemsLighting}" SelectedValue="{Binding VoltageId}"/>
                                                                        </Grid>
                                                                        <Grid Margin="20 0 10 0">
                                                                            <Label  Content="Watts" VerticalAlignment="Top" HorizontalAlignment="Left"  FontWeight="Bold"/>
                                                                            <TextBox Height="30" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="0 20 0 0" Width="70" Text="{Binding Wattage}"></TextBox>
                                                                        </Grid>
                                                                    </StackPanel>
                                                                </Grid>
                                                                <Grid Margin="20 0 0 0">
                                                                    <Label Content="Qty." FontWeight="Bold"/>
                                                                    <TextBox Height="30" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="0 20 0 0" Width="43">
                                                                        <TextBox.Text>
                                                                            <Binding Path="Qty" UpdateSourceTrigger="PropertyChanged">
                                                                                <Binding.ValidationRules>
                                                                                    <local:MinimumValueValidationRule Minimum="1"/>
                                                                                </Binding.ValidationRules>
                                                                            </Binding>
                                                                        </TextBox.Text>
                                                                    </TextBox>
                                                                </Grid>

                                                                <Grid Margin="20 -20 0 0">
                                                                    <Label Content="Panel" FontWeight="Bold"/>
                                                                    <ComboBox Height="20" Width="150" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="0 20 0 0" SelectedValue="{Binding ParentId}" SelectedValuePath="Key" ItemsSource="{Binding DataContext.PanelNames, RelativeSource={RelativeSource AncestorType=UserControl}}" DisplayMemberPath="Value"/>

                                                                    <Label Content="Distance" Margin="0 35 0 0" FontWeight="Bold"/>
                                                                    <TextBox Height="20" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="0 55 0 0" Width="150"></TextBox>
                                                                </Grid>

                                                                <Grid Margin="20 0 0 0">
                                                                    <Label Content="AIC Rating" FontWeight="Bold"/>
                                                                    <TextBox Height="30" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="0 20 0 0" Width="70"></TextBox>
                                                                </Grid>

                                                                <Grid Margin="20 -40 0 0">
                                                                    <Button  Height="20" Width="100" Content="View Spec" FontWeight="Bold" HorizontalAlignment="Left"/>
                                                                    <Button Margin="0 60 0 0" Height="20" Width="100" Content="Change Spec" FontWeight="Bold" HorizontalAlignment="Left"/>
                                                                </Grid>
                                                               
                                                            </StackPanel>
                                                        </StackPanel>
                                                        <Expander Grid.Row="1" HorizontalAlignment="Left" Header="Description" FontWeight="Bold">
                                                            <TextBox x:Name="DescriptionBox" Height="100" Width="400" Margin="2 2 2 5" Text="{Binding Description}" MaxLength="25"/>
                                                        </Expander>
                                                        <Grid Margin="0, 0, 0, 0" HorizontalAlignment="Right" VerticalAlignment="Stretch" Grid.RowSpan="2">
                                                            <Rectangle x:Name="DeleteSeparator" HorizontalAlignment="Right" Height="Auto" Margin="0,0,80,0" Stroke="LightGray" VerticalAlignment="Stretch"/>
                                                            <Button Height="20" Width="50" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="0 0 0 0" Content="Delete" FontWeight="Bold" Click="DeleteSelectedElectricalLighting" CommandParameter="{Binding}"/>
                                                        </Grid>
                                                    </Grid>
                                                    <DataTemplate.Triggers>
                                                        <Trigger Property="ItemsControl.AlternationIndex" Value="0">
                                                            <Setter Property="Background" Value="White" TargetName="EquipmentGrid"/>
                                                            <Setter Property="Stroke" Value="LightGray" TargetName="DeleteSeparator"/>
                                                        </Trigger>
                                                        <Trigger Property="ItemsControl.AlternationIndex" Value="1">
                                                            <Setter Property="Background" Value="LightGray" TargetName="EquipmentGrid"/>
                                                            <Setter Property="Stroke" Value="White" TargetName="DeleteSeparator"/>
                                                        </Trigger>
                                                    </DataTemplate.Triggers>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>
                                        <!-- End Dynamic -->
                                    </ScrollViewer>
                                </Grid>
                            </GroupBox>
                        </TabItem>
                    </TabControl>
                </Grid>
            </TabItem>
            <TabItem Header="Plumbing" Visibility="Visible">
                <Grid Background="DarkMagenta"/>
            </TabItem>
            <TabItem Header="" Visibility="Hidden">
                <Grid Background="DarkMagenta"/>
            </TabItem>
            <TabItem Header="Info" Visibility="Visible">
                <Grid Background="Gainsboro"/>
            </TabItem>
        </TabControl>

        <Grid Background="White" Height="22" Margin="0 0 4 0" HorizontalAlignment="Right" VerticalAlignment="Top">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <Rectangle Width="1" Stroke="Black" Height="19" Margin="0 0 5 0"/>
                <TextBlock x:Name="SaveText" Height="22" HorizontalAlignment="Right" Margin="0 0 5 0"/>
            </StackPanel>
        </Grid>
    </Grid>
</UserControl>
